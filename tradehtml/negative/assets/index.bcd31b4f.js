"use strict";(self.webpackChunkcomb_trade=self.webpackChunkcomb_trade||[]).push([["src_common_bizComps_LeadTraderRiskConfirm_action_js-src_common_pages_trade_modules_PlaceOrder-0f6a24","sw_bundle_PlaceOrder-actions-spotAction","Scaled-Futures-Action-FormAction"],{59326:(e,t,i)=>{i.d(t,{A:()=>T});var r=i(90675),n=i(5544),o=i(10467),a=i(92901),s=i(23029),c=(i(41594),i(10816)),u=i(63010),l=i(4536),d=i(30631),v=i(29613),p=i(75376),f=i(95632),A=i(82155),h=i(5366),g=i(17500),m=i(57209),y=i(41140),k=i(95577);const _="index_risk-description__ZxIVo";var P=i(19919);const b=(0,y.observer)((function(){var e=g.A.riskInfo,t=g.A[h.IW[e.name]];return(0,P.jsxs)("div",{children:[(0,P.jsx)("p",{className:_,children:(0,l.kW)(h.Dq[e.name],{num:e.value,ccy:e.ccy[0]})}),(0,P.jsx)(k.A,{size:k.A.SIZE.md,textClass:"f14",onChange:T.setRemindStatus,checked:t,children:(0,l.kW)("trade_lead_checkbox_dont_remind_today")})]})}));const T=new((0,a.A)((function e(){var t=this;(0,s.A)(this,e),this.verifyLeadTrader=(0,o.A)((0,r.A)().mark((function e(){var i,o,a,s,A,m,y,k,_;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=v.A.copyInfo,o=i.isSwapTrader,a=i.swapTraderInsts,s=p.A.instId,!(o&&a.includes(s))){e.next=19;break}return e.next=7,(0,c.A)(f.A.verifyLeadTraderRisk({instId:s}));case 7:if(A=e.sent,m=(0,n.A)(A,2),y=m[0],k=m[1],!(y||(null===k||void 0===k?void 0:k.data.length)<1)){e.next=13;break}return e.abrupt("return",!0);case 13:if(_=((null===k||void 0===k?void 0:k.data)||[]).find((function(e){return!u.A.get(h.fQ[e.name])}))){e.next=16;break}return e.abrupt("return",!0);case 16:return g.A.updateByKey("riskInfo",_),t.dialog=d.A.tip({infoType:d.A.Tip.INFO_TYPE.warn,title:(0,l.kW)("trade_lead_popup_header_cant_lead"),children:(0,P.jsx)(b,{}),confirmText:(0,l.kW)("trade_lead_popup_btn_back"),cancelText:(0,l.kW)("trade_lead_popup_btn_trade_anyway"),onConfirm:function(){t.dialog.destroy()},onClose:function(){t.continueTrade(),t.dialog.destroy()}}),e.abrupt("return",!1);case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e)}))),this.setRemindStatus=function(e){var t=g.A.riskInfo,i=(void 0===t?{}:t).name||"",r=h.IW[i],n=h.fQ[i]||"";n&&(e.target.checked?u.A.set(n,!0,h.td-(60*m.A.get("h")*60+60*m.A.get("m")+m.A.get("s"))):u.A.remove(n),g.A.updateByKey(r,e.target.checked))},this.continueTrade=function(){var e=g.A.direction,t=g.A.buttonItem;g.A.updateByKey("skipVerify",!0),A.default.onClickSubmit(e)(t)}})))},5366:(e,t,i)=>{i.d(t,{Dq:()=>n,IW:()=>r,fQ:()=>o,td:()=>a});var r={tradeNum:"tradeNumStatus",totalPositionEq:"positionStatus",accountEq:"accountStatus"},n={tradeNum:"trade_lead_popup_body_daily_limit",totalPositionEq:"trade_lead_popup_body_position_limit",accountEq:"trade_lead_popup_body_insufficient_funds"},o={tradeNum:"trade_lead_remind_trade_num_limit",totalPositionEq:"trade_lead_remind_total_position_limit",accountEq:"trade_lead_remind_account_limit"},a=86400},17500:(e,t,i)=>{i.d(t,{A:()=>d});var r=i(92901),n=i(23029),o=i(39874),a=i(85501),s=i(44497),c=i(15227),u=i(76196),l=i(5366);const d=new(function(e){function t(){var e;return(0,n.A)(this,t),(e=(0,o.A)(this,t)).riskInfo=null,e.tradeNumStatus=!!(0,c.zM)(l.fQ.tradeNum),e.positionStatus=!!(0,c.zM)(l.fQ.totalPositionEq),e.accountStatus=!!(0,c.zM)(l.fQ.accountEq),e.direction="",e.buttonItem={},e.skipVerify=!1,(0,s.makeObservable)(e,{riskInfo:s.observable,tradeNumStatus:s.observable,positionStatus:s.observable,accountStatus:s.observable,direction:s.observable,buttonItem:s.observable,skipVerify:s.observable}),e}return(0,a.A)(t,e),(0,r.A)(t)}(u.A))},58461:(e,t,i)=>{i.d(t,{Lg:()=>v,M0:()=>l,vu:()=>u,yB:()=>d});var r=i(71491),n=r._u.div,o=r._u.sub,a=r._u.mul,s=r._u.add,c=r._u.toPlainString,u=function(e,t){return c(n(e,t,{returnString:!0}))},l=function(e,t){return c(o(e,t,{returnString:!0}))},d=function(e,t){return c(a(e,t,{returnString:!0}))},v=function(e,t){return c(s(e,t,{returnString:!0}))}},99017:(e,t,i)=>{i.d(t,{JB:()=>h,Md:()=>l,Ou:()=>p,X4:()=>A,pQ:()=>v,wp:()=>f});var r=i(71491),n=i(58461),o=r._u.ceilTruncate,a=r._u.toPlainString,s=r._u.gt,c=r._u.max,u=r._u.min,l=16,d=function(e,t){var i=e.accountCheckedInitValues,d=e.assetAvail,v=e.simpleEarnAvail,p=e.availableValue,f=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return a(o(function(e,t){r._u.config({returnString:!0});var i=c(e,t);return r._u.config({returnString:!1}),i}(0,function(e,t){r._u.config({returnString:!0});var i=u(e,t);return r._u.config({returnString:!1}),i}(e,t)),i))},A=function(e,t){return s(e,t)?a(t):e};if(i.isAssetAccountChecked&&i.isEarnAccountChecked){var h=(0,n.M0)(t,p),g=f(d,h);return{fundTransferAmount:A(g,d),earnedCoinTransferAmount:A(f(v,(0,n.M0)(h,g),8),v)}}return i.isAssetAccountChecked?{fundTransferAmount:A(f(d,(0,n.M0)(t,p)),d),earnedCoinTransferAmount:""}:i.isEarnAccountChecked?{fundTransferAmount:"",earnedCoinTransferAmount:A(f(v,(0,n.M0)(t,p),8),v)}:{fundTransferAmount:"",earnedCoinTransferAmount:""}},v=function(e){var t=e.accountCheckedInitValues,i=e.assetAvail,r=e.simpleEarnAvail,o=e.threshold,a=e.price,s=e.total,c=e.availableValue,u=e.sizePrecision,l=(0,n.vu)((0,n.vu)(s,a),(0,n.M0)(1,o));return d({accountCheckedInitValues:t,assetAvail:i,simpleEarnAvail:r,availableValue:c,precision:u},l)},p=function(e){var t=e.accountCheckedInitValues,i=e.assetAvail,r=e.simpleEarnAvail,o=e.threshold,a=e.price,s=e.size,c=e.availableValue,u=e.quotePrecision,l=(0,n.yB)(a,s),v=(0,n.yB)(l,(0,n.Lg)(1,o));return d({accountCheckedInitValues:t,assetAvail:i,simpleEarnAvail:r,availableValue:c,precision:u},v)},f=function(e){var t=e.accountCheckedInitValues,i=e.assetAvail,r=e.simpleEarnAvail,o=e.price,a=e.size,s=e.availableValue,c=e.quotePrecision,u=(0,n.yB)(o,a);return d({accountCheckedInitValues:t,assetAvail:i,simpleEarnAvail:r,availableValue:s,precision:c},u)},A=function(e){var t=e.accountCheckedInitValues,i=e.assetAvail,r=e.simpleEarnAvail,n=e.total,o=e.availableValue,a=e.quotePrecision;return d({accountCheckedInitValues:t,assetAvail:i,simpleEarnAvail:r,availableValue:o,precision:a},n)},h=function(e){var t=e.accountCheckedInitValues,i=e.assetAvail,r=e.simpleEarnAvail,n=e.size,o=e.availableValue,a=e.sizePrecision;return d({accountCheckedInitValues:t,assetAvail:i,simpleEarnAvail:r,availableValue:o,precision:a},n)}},7933:(e,t,i)=>{i.d(t,{A:()=>h});var r=i(64467),n=i(23029),o=i(92901),a=i(44497),s=i(71491),c=i(75376),u=i(44005),l=i(28494),d=i(84954),v=i(83268),p=i(25594),f=i(8413),A=["isTpSl","price","tpOrdPx","tpTriggerPx","slTriggerPx","triggerPrice","tpTriggerPrice","slTriggerPrice"];const h=function(){return(0,o.A)((function e(t){var i=this,r=t.onPriceUpdate,o=t.updateAvailable,s=t.getPriceFormFields,c=t.isBuySellMode,l=void 0!==c&&c;(0,n.A)(this,e),this.onPriceUpdate=void 0,this.updateAvailable=void 0,this.getPriceFormFields=void 0,this.isBuySellMode=void 0,this.activeDirection="",this.orderType=p.W4.LIMIT,this.previewLineMoveHandler=null,this.prefillPriceHandler=null,this.destroyFormListeners=null,this.activeField="",this.currentListenerDirection=null,this.setActiveDirection=function(e){i.activeDirection=e||i.getDefaultDirection()},this.setOrderType=function(e){i.orderType=e,i.clearLinesAndCache()},this.onPreviewLineMoved=function(e){var t=e.price,r=e.fieldName;r&&(0,v.Et)(t)&&i.updatePriceAndAvailable({price:t,fieldName:r})},this.onPrefillPriceChanged=function(e){var t=i.orderType,r=e.price,n=i.getFieldName(i.activeDirection,t);r&&n&&i.updatePriceAndAvailable({price:r,fieldName:n})},this.isDrawLineBlackList=function(e){var t,r=e.direction,n=null===(t=i.getPriceFormFields)||void 0===t?void 0:t.call(i,r);return i.orderType===p.Mw.SCALED||(null===n||void 0===n?void 0:n.isTrackingOrdersChecked)&&(null===n||void 0===n?void 0:n.optionActiveInput)!==u.WM.K_PRICE},this.isDrawLineWhiteList=function(e){var t=e.key;return A.includes(t)},this.checkClearLinesAndCache=function(e){var t,r=e.key,n=e.direction,o=((null===(t=i.getPriceFormFields)||void 0===t?void 0:t.call(i,n))||{}).isTpSl;(["algoType","advType","bboChecked","isTrackingOrdersChecked","optionActiveInput"].includes(r)||!o&&"isTpSl"===r)&&i.clearLinesAndCache()},this.clearLinesAndCache=function(){d.F.trigger(d.w.onPreviewLinesCleared,null),i.setActiveDirection(),i.activeField=""},(0,a.makeAutoObservable)(this),this.onPriceUpdate=r,this.updateAvailable=o,this.getPriceFormFields=s,this.isBuySellMode=l,this.setActiveDirection(),this.initPriceListeners()}),[{key:"initPriceListeners",value:function(){var e=this;this.destroyFormListeners=(0,a.reaction)((function(){return e.activeDirection}),(function(){e.resetPriceListeners()}),{fireImmediately:!0})}},{key:"getDefaultDirection",value:function(){var e=c.A.instStatus.isSpotOrMargin,t=l.M8.LEFT;return this.isBuySellMode?l.g2.BUY:e&&this.activeDirection||t}},{key:"setupPreviewLineMoveListener",value:function(e){this.currentListenerDirection===e&&this.previewLineMoveHandler||(this.previewLineMoveHandler&&d.F.removeListener(d.w.onPreviewLineMoved,this.previewLineMoveHandler),this.previewLineMoveHandler=this.onPreviewLineMoved,this.currentListenerDirection=e,d.F.addListener(d.w.onPreviewLineMoved,this.previewLineMoveHandler))}},{key:"drawPreviewLinesCore",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).filter((function(e){var t=e.price;return s._u.gt(t,0)}));d.F.trigger(d.w.onPreviewLinesUpdated,t),this.setupPreviewLineMoveListener(e)}},{key:"drawPreviewLines",value:function(e){var t=this;return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.drawPreviewLinesCore(e,i)}}},{key:"drawScaledOrderPreviewLines",value:function(e){var t=this;return function(){var i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r&&0!==r.length){var n=null===(i=t.getPriceFormFields)||void 0===i?void 0:i.call(t),o=null===n||void 0===n?void 0:n.minPrice,a=null===n||void 0===n?void 0:n.maxPrice;if(o&&a){var s=(0,f.$F)(r,{minPrice:o,maxPrice:a});t.drawPreviewLinesCore(e,s)}}}}},{key:"updatePriceAndAvailable",value:function(e){var t,i=e.price,r=e.fieldName;this.onPriceUpdate(this.activeDirection,r,i),null===(t=this.updateAvailable)||void 0===t||t.call(this)}},{key:"clearPreviewLines",value:function(){d.F.trigger(d.w.onPreviewLinesCleared,null),this.activeField="",this.previewLineMoveHandler&&(d.F.removeListener(d.w.onPreviewLineMoved,this.previewLineMoveHandler),this.previewLineMoveHandler=null,this.currentListenerDirection=null)}},{key:"getFieldName",value:function(e,t){var i=(0,r.A)((0,r.A)((0,r.A)((0,r.A)((0,r.A)({},p.W4.LIMIT,"price"),p.Mw.STOP_LIMIT,{conditional:"triggerPrice",oco:"tpTriggerPrice"}),p.Mw.TRIGGER,"triggerPrice"),p.W4.ADV,"price"),p.Mw.SCALED,"minPrice"),n=i[t];if(t===p.Mw.STOP_LIMIT){var o,a=null===(o=this.getPriceFormFields)||void 0===o?void 0:o.call(this,e);if(a&&"algoType"in a){var s=a.algoType,c=i[t],u=c.conditional,l=c.oco;n=s===p.Mw.OCO?l:u}}return this.activeField||n}},{key:"listenPrefillPriceChange",value:function(){this.prefillPriceHandler&&d.F.removeListener(d.w.onPrefillPriceChanged,this.prefillPriceHandler),this.prefillPriceHandler=this.onPrefillPriceChanged,d.F.addListener(d.w.onPrefillPriceChanged,this.onPrefillPriceChanged)}},{key:"resetPriceListeners",value:function(){d.F.trigger(d.w.onPreviewLinesCleared,null),this.listenPrefillPriceChange()}},{key:"checkDrawPreviewLines",value:function(e){var t,i=e.direction,r=e.key,n=this.orderType,o=null===(t=this.getPriceFormFields)||void 0===t?void 0:t.call(this,i);this.isDrawLineBlackList({direction:i})||o&&this.isDrawLineWhiteList({key:r})&&(n===p.W4.LIMIT||n===p.W4.ADV?this.drawPreviewLines(i)((0,f.iB)(o)):n===p.Mw.STOP_LIMIT?this.drawPreviewLines(i)((0,f.u0)(o)):n===p.Mw.TRIGGER&&this.drawPreviewLines(i)((0,f.xu)(o)))}},{key:"onInputFocus",value:function(e,t){this.setActiveDirection(e),this.activeField=(0,f.Uh)(t)?t:""}},{key:"destroy",value:function(){this.clearPreviewLines(),this.prefillPriceHandler&&(d.F.removeListener(d.w.onPrefillPriceChanged,this.prefillPriceHandler),this.prefillPriceHandler=null),this.destroyFormListeners&&(this.destroyFormListeners(),this.destroyFormListeners=null)}}])}()},8413:(e,t,i)=>{i.d(t,{$F:()=>g,RY:()=>d,Uh:()=>v,iB:()=>f,u0:()=>A,xu:()=>h});var r=i(60436),n=i(64467),o=i(4536),a=i(71491),s=i(25594),c=s.Mw.STOP_LIMIT,u=s.Mw.TRIGGER,l=s.Mw.SCALED,d=[s.W4.LIMIT,s.W4.ADV,c,u,l],v=function(e){return["price","tpOrdPx","tpTriggerPx","slTriggerPx","triggerPrice","tpTriggerPrice","slTriggerPrice","tpOrderPrice","slOrderPrice","orderPrice","minPrice","maxPrice","triggerLimitPrice"].includes(e)},p=function(e,t){var i;return(null===(i=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},s.W4.LIMIT,{price:(0,o.kW)("trade_charts_tag_new_limit"),tpOrdPx:(0,o.kW)("trade_charts_tag_new_tp"),tpTriggerPx:(0,o.kW)("trade_charts_tag_new_tp"),slTriggerPx:(0,o.kW)("trade_charts_tag_new_sl")}),c,{triggerPrice:(0,o.kW)("trade_charts_tag_new_tpsl"),tpTriggerPrice:(0,o.kW)("trade_charts_tag_new_tpsl"),slTriggerPrice:(0,o.kW)("trade_charts_tag_new_tpsl")}),u,{triggerPrice:(0,o.kW)("trade_charts_tag_new_trigger")}),s.W4.ADV,{price:(0,o.kW)("trade_charts_tag_new_post_only"),tpOrdPx:(0,o.kW)("trade_charts_tag_new_tp"),tpTriggerPx:(0,o.kW)("trade_charts_tag_new_tp"),slTriggerPx:(0,o.kW)("trade_charts_tag_new_sl")})[e])||void 0===i?void 0:i[t])||""},f=function(e){return[{price:e.price||"",text:p(s.W4.LIMIT,"price"),fieldName:"price"}].concat((0,r.A)(function(e){var t=[{price:e.slTriggerPx||"",text:p(s.W4.LIMIT,"slTriggerPx"),fieldName:"slTriggerPx",isDashBorderStyle:!0}];return e.tpTriggerPx?t.push({price:e.tpTriggerPx,text:p(s.W4.LIMIT,"tpTriggerPx"),fieldName:"tpTriggerPx",isDashBorderStyle:!0}):t.push({price:e.tpOrdPx||"",text:p(s.W4.LIMIT,"tpOrdPx"),fieldName:"tpOrdPx",isDashBorderStyle:!0}),t}(e)))},A=function(e){return e.algoType===s.Mw.OCO?[{price:e.tpTriggerPrice||"",text:p(c,"tpTriggerPrice"),fieldName:"tpTriggerPrice"},{price:e.slTriggerPrice||"",text:p(c,"slTriggerPrice"),fieldName:"slTriggerPrice"}]:e.algoType===s.Mw.CONDITIONAL?[{price:e.triggerPrice||"",text:p(c,"triggerPrice"),fieldName:"triggerPrice"}]:[]},h=function(e){return[{price:e.triggerPrice||"",text:p(u,"triggerPrice"),fieldName:"triggerPrice"}]},g=function(e,t){var i=t.minPrice,r=t.maxPrice;if(!e||0===e.length)return[];var n=e.length;return e.map((function(e,t){var s="";return a._u.eq(e.price,i)?s="minPrice":a._u.eq(e.price,r)&&(s="maxPrice"),{price:e.price,text:(0,o.kW)("trade_charts_tag_new_limit"),fieldName:s,moveable:0===t||t===n-1}}))}},82155:(e,t,i)=>{i.r(t),i.d(t,{default:()=>We});var r=i(64467),n=i(53986),o=i(90675),a=i(89379),s=i(10467),c=i(23029),u=i(92901),l=i(4473),d=i(68341),v=i(44497),p=i(71491),f=i(63010),A=i(4536),h=i(60713),g=i(75376),m=i(29613),y=i(4417),k=i(59326),_=i(17500),P=i(30293),b=i(58461),T=i(99017),C=i(35446),w=i(98893),I=i(64397),x=i(53284),S=i(15227),L=i(28494),M=i(75627),O=i(30376),B=i(22291);const F=function(e){return(0,B.Jt)("".concat(O.x0,"/market/books"),e)};var D=i(52796),E=i(91340),z=i(17450),V=i(84954),W=E.A.pub.books5,R=(0,d.A)("reactionInst"),N=(0,d.A)("setInst"),q=(0,d.A)("scribe"),j=function(){return(0,u.A)((function e(t){var i=this;(0,c.A)(this,e),this.init=function(){var e=(0,s.A)((0,o.A)().mark((function e(t){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,l.A)(i,N)[N](t),i.initBooks(),i.reactionInst=(0,l.A)(i,R)[R]();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object.defineProperty(this,R,{writable:!0,value:function(){return(0,v.reaction)((function(){return{instId:g.A.instId}}),(function(e){var t=e.instId;t!==i.store.instId&&(i.destroy(),(0,l.A)(i,N)[N]({instId:t}),i.initBooks())}),{fireImmediately:!0})}}),this.initBooks=(0,s.A)((0,o.A)().mark((function e(){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.fetchBooks();case 2:V.F.addListener(V.w.onInPubWsError,i.fetchBooks),z.Ay.addCallback(W,i.updateBooksWs),(0,l.A)(i,q)[q]("sub");case 5:case"end":return e.stop()}}),e)}))),this.destroy=function(){V.F.removeListener(V.w.onInPubWsError,i.fetchBooks),z.Ay.removeCallback(W,i.updateBooksWs),(0,l.A)(i,q)[q]("unsub"),i.reactionInst()},Object.defineProperty(this,N,{writable:!0,value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.instId,r=void 0===t?g.A.instId:t,n=e.sz,o=void 0===n?i.store.sz:n;i.store.update({instId:r,sz:o})}}),this.fetchBooks=(0,s.A)((0,o.A)().mark((function e(){var t;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F({instId:i.store.instId,sz:i.store.sz});case 2:t=e.sent,(0,v.runInAction)((function(){i.updateBooks(t)}));case 4:case"end":return e.stop()}}),e)}))),this.updateBooksWs=function(e){var t;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.length&&i.updateBooks(e.data[0])},Object.defineProperty(this,q,{writable:!0,value:function(e){var t=i.store,r=t.instId,n=t.sz,o=g.A.insts[g.A.instType][r],a=o.instType,s=o.uly,c=D.A.pub.getBooks({instId:r,instType:a,uly:s,sz:n});"sub"===e?(i.booksChannel=c,z.ax.subscribe(c)):z.ax.unsubscribe(i.booksChannel)}}),this.booksChannel=[],this.store=t,this.reactionInst=null}),[{key:"updateBooks",value:function(e){var t=e.asks,i=void 0===t?[]:t,r=e.bids,n=void 0===r?[]:r,o=e.instId;this.store.instId===o&&this.store.update({asks:i,bids:n,initialized:!0})}}])}();const U=j;var H=i(99782),K=i(5249),Q=i(97480),G=i.n(Q),Y=i(84854),X=i(82881),Z=i(21217),J=i(8786),$=i(25594),ee=i(33400),te=i(5544),ie=i(41594),re=i(95577),ne=i(30631),oe=i(42182),ae=i(19919),se=function(e){var t=e.afterChange,i=void 0===t?oe.x7:t,r=(0,ie.useState)(!1),n=(0,te.A)(r,2),o=n[0],a=n[1],s=(0,ie.useCallback)((function(e){var t=e.target.checked;a(t),i(t)}),[i]);return(0,ae.jsx)("div",{style:{marginTop:16},children:(0,ae.jsx)(re.A,{onChange:s,checked:o,children:(0,A.kW)("spot_placeorder_modal_reminder_checkbox")})})},ce=i(64760),ue=i(99713),le=i(50301),de=i(65555),ve=i(50347),pe=i(93121),fe=i(7933),Ae=i(55859),he=i(94779),ge=i(72512),me=i(33060),ye=i(59169),ke=i(79616),_e=i(5625),Pe=function(){var e=(0,s.A)((0,o.A)().mark((function e(t){var i;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,X.default.setBtnLoading(t.type,!0),e.next=4,_e.A.openOption();case 4:i=ne.A.success({title:(0,A.kW)("trade_options_assetsverify_pass"),text:(0,A.kW)("trade_options_assetsverify_pass_desc"),confirmText:(0,A.kW)("options_buyoptions_modal_btn_confirm"),onConfirm:function(){i.destroy()}}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)===me.PW?(0,ke.LM)(e.t0):(0,ye.Z2)(e.t0);case 10:return e.prev=10,X.default.setBtnLoading(t.type,!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}(),be=i(87795),Te=["validInfo"],Ce=["direction","buttonItem"],we=new U(H.N),Ie=p._u.gt,xe=p._u.floorTruncate,Se=L.LT.PRICE_QUOTE,Le=L.LT.SIZE_BASE,Me=$.g2.BUY,Oe=$.g2.SELL,Be=$.Mw.STOP_LIMIT,Fe=$.Mw.TRIGGER,De=$.Mw.MOVE_STOP,Ee=(0,d.A)("checkBeforeMonitor"),ze=(0,d.A)("checkInputError"),Ve=(0,d.A)("checkSimpleConfirm");const We=new(function(){return(0,u.A)((function e(){var t=this;(0,c.A)(this,e),this.linesClearReaction=null,this.orderTypeReaction=null,this.unitChangeReaction=null,this.onCloseConfirmWithCheck=function(e){return function(t){t&&f.A.set(e,!0)}},Object.defineProperty(this,Ee,{writable:!0,value:function(e,i){var r=he.A.isUnTradeAble,n=he.A.optionIsNotOpened,o=he.A.buttonsLoading[e.type];if(!o&&n)return Pe(e),!1;if(r)return J.A.closeSmPlaceOrder(),t.onClickSubmitMonitor(e,i),de.A.openAccountLevelDrawer(),!1;var a=be.A.instAction;return!!(null===a||void 0===a?void 0:a.store)&&!o}}),Object.defineProperty(this,ze,{writable:!0,value:function(e){var t=e.mainCheckAction,i=e.form,r=e.instAction,n=e.direction,o=e.buttonItem,a=e.fields,s=t.checkForm({form:i,direction:n,buttonItem:o,fields:a}),c=s.inputErrors,u=s.formErrorMsg;(0,ge.Oi)({value:c,direction:n,instAction:r}),(0,ge.Vh)({value:u,direction:n,instAction:r});var l=Object.keys(c);if(l.length||u){var d=l[0];if(d){var v=document.querySelector("#".concat(n,"PoForm input[name=").concat(d,"]"));v&&v.focus()}return!1}return!0}}),Object.defineProperty(this,Ve,{writable:!0,value:function(){var e=(0,s.A)((0,o.A)().mark((function e(t){var i,r,n,s,c,u,l,d,v,p,f,h,m,y,k,_,P;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.mainCheckAction,r=t.form,n=t.buttonItem,s=he.A.orderTypeStatus,!s.isAlgoType){e.next=9;break}if(c=i.noFillAfterTriggerCheck({form:r,buttonItem:n}),u=c.noFillCheckMsg,l=c.notAgainKey,d=c.description,!u){e.next=7;break}return e.abrupt("return",X.default.mainDialogAction.simpleConfirm(u,l,{description:d,confirmText:(0,A.kW)("futures_placeorder_popup_buy_btn_continue"),cancelText:(0,A.kW)("futures_placeorder_popup_buy_btn_cancel")}));case 7:e.next=15;break;case 9:if(!(v=i.stablecoinPriceCheck({form:r,buttonItem:n}))){e.next=12;break}return e.abrupt("return",X.default.mainDialogAction.simpleConfirm(v));case 12:if(!(p=i.askBidCheck({form:r,buttonItem:n}))){e.next=15;break}return e.abrupt("return",X.default.mainDialogAction.simpleConfirm(p));case 15:if(!g.A.instStatus.isSpot){e.next=21;break}return f=r.isTp,h=r.isSl,m=r.tpOrdPx,y=r.tpTriggerPx,k=r.slOrdPx,_=r.slTriggerPx,e.next=19,(0,C.vH)((0,a.A)((0,a.A)((0,a.A)({},f?{tpOrdPx:m,tpTriggerPx:y}:{}),h?{slOrdPx:k,slTriggerPx:_}:{}),{},{side:n.side===Me?Oe:Me}));case 19:return P=e.sent,e.abrupt("return",P);case 21:return e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),this.checkLockingStatus=function(){return!he.A.submitConfirmLocking&&(he.A.update({submitConfirmLocking:!0}),!0)},this.checkMonitorStatus=function(e,i){return!!(0,l.A)(t,Ee)[Ee](e,i)&&(t.onClickSubmitMonitor(e,i),!0)},this.getDirectionForm=function(e){var t=be.A.instAction,i=null===t||void 0===t?void 0:t.store;return{form:null===i||void 0===i?void 0:i["".concat(e,"Form")],instAction:t}},this.getPriceFormFields=function(e){var i,r=null===(i=t.getDirectionForm(e))||void 0===i?void 0:i.form;return{price:null===r||void 0===r?void 0:r.price,tpOrdPx:null===r||void 0===r?void 0:r.tpOrdPx,tpTriggerPx:null===r||void 0===r?void 0:r.tpTriggerPx,slTriggerPx:null===r||void 0===r?void 0:r.slTriggerPx,triggerPrice:null===r||void 0===r?void 0:r.triggerPrice,tpTriggerPrice:null===r||void 0===r?void 0:r.tpTriggerPrice,slTriggerPrice:null===r||void 0===r?void 0:r.slTriggerPrice,tpOrderPrice:null===r||void 0===r?void 0:r.tpOrderPrice,slOrderPrice:null===r||void 0===r?void 0:r.slOrderPrice,orderPrice:null===r||void 0===r?void 0:r.orderPrice,algoType:null===r||void 0===r?void 0:r.algoType,isTrackingOrdersChecked:null===r||void 0===r?void 0:r.isTrackingOrdersChecked,optionActiveInput:null===r||void 0===r?void 0:r.optionActiveInput,isTpSl:null===r||void 0===r?void 0:r.isTpSl}},this.getMainPreActions=function(){var e=(0,s.A)((0,o.A)().mark((function e(t){var i,r;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,ee.XG)();case 3:return i=e.sent,X.default.mainDialogAction=i,e.next=7,(0,ee.Tx)();case 7:r=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),X.default.setBtnLoading(t,!1);case 13:return e.abrupt("return",{mainDialogAction:i,mainCheckAction:r});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),this.onClickSubmit=function(e){return function(){var i=(0,s.A)((0,o.A)().mark((function i(r,s){var c,u,d,v,p,f,A,h,m,P,b,T,C,w;return(0,o.A)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null===s||void 0===s||s.persist(),null===s||void 0===s||null===(c=s.target)||void 0===c||c.blur(),u=g.A.instType,d=g.A.instId,v=r.collateralCoin,!(p=void 0===v?"":v)){i.next=8;break}return i.next=7,y.E.openDialog({instType:u,instId:d,mgnMode:he.A.tradeMode,ccy:p,pageType:L.H.TRADE,orderType:he.A.orderType});case 7:return i.abrupt("return");case 8:return i.next=10,Ae.G.openPreMarketDialog({instType:u,instId:d});case 10:if(_.A.skipVerify){i.next=17;break}return _.A.update({direction:e,buttonItem:r}),i.next=14,k.A.verifyLeadTrader();case 14:if(i.sent){i.next=17;break}return i.abrupt("return");case 17:if(_.A.updateByKey("skipVerify",!1),f=t.getDirectionForm(e),A=f.form,h=f.instAction,t.checkMonitorStatus(r,A)){i.next=21;break}return i.abrupt("return");case 21:return t.runBury({direction:e,form:A}),X.default.setBtnLoading(r.type,!0),i.next=25,t.getMainPreActions(r.type);case 25:if(m=i.sent,P=m.mainDialogAction,b=m.mainCheckAction,(0,l.A)(t,ze)[ze]({mainCheckAction:b,form:A,instAction:h,direction:e,buttonItem:r})){i.next=32;break}return X.default.setBtnLoading(r.type,!1),i.abrupt("return");case 32:return i.next=34,Z.A.checkOnClickSubmit();case 34:if(i.sent){i.next=38;break}return X.default.setBtnLoading(r.type,!1),i.abrupt("return");case 38:return i.next=40,(0,l.A)(t,Ve)[Ve]({mainCheckAction:b,form:A,buttonItem:r});case 40:if(i.sent){i.next=44;break}return X.default.setBtnLoading(r.type,!1),i.abrupt("return");case 44:return i.prev=44,i.next=47,X.default.instAction.onSubmit(r,e);case 47:if(T=i.sent,X.default.setBtnLoading(r.type,!1),T){i.next=51;break}return i.abrupt("return");case 51:return C=T.validInfo,w=(0,n.A)(T,Te),i.next=54,P.onPreSubmit({validInfo:C,direction:e});case 54:if(i.sent){i.next=57;break}return i.abrupt("return");case 57:he.A.update({submitConfirmLocking:!0}),t.innerShowSubmitConfirm((0,a.A)({direction:e,buttonItem:r},w)),i.next=64;break;case 61:i.prev=61,i.t0=i.catch(44),X.default.setBtnLoading(r.type,!1);case 64:case"end":return i.stop()}}),i,null,[[44,61]])})));return function(e,t){return i.apply(this,arguments)}}()},this.onClickSubmitMonitor=function(e,t){var i=t.algoType,n=e.side,o=he.A.isNetMode,a=he.A.isCloseMode,s=he.A.orderType,c=he.A.isUnTradeAble,u=g.A.instType,l=g.A.instId,d=(0,r.A)((0,r.A)({},Be,i),$.W4.ADV,"advanced_limit"),v={token_pair:l.toUpperCase(),biz_type:u.toLowerCase(),side:n,position_side:"net",order_type:d[s]||s,layout:(0,x.MC)([le.A.layoutId]),is_demo:!!(0,I.yI)()};o||(v.position_side=a?"close":"open"),c&&(v.button_name="switch_account_mode"),(0,K.gAz)(v)},this.clickLever=function(e){var i,r=e.direction,n=e.side,o=e.lever,s=(0,ce.l)({lever:o,side:n,instStore:g.A,mainStore:he.A}),c=s.instId,u=he.A.isAccountMultiCrossWithSpotMargin,l=(0,a.A)((0,a.A)((0,a.A)({},s),t.innerGetSportOrMarginLeverConfig(r)),{},{isMuiSpotOrMarCroTd:u,onSuccess:function(){be.A.getMaxAvail({instId:c}),be.A.getUserLevers()}});null===(i=be.A.instAction)||void 0===i||i.handleAdjustLeverModal({isShow:!0,props:l})},this.checkInput=function(){var e=(0,s.A)((0,o.A)().mark((function e(i,r){var n,a,s,c,u;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getDirectionForm(i),a=n.form,s=n.instAction,e.next=3,(0,ee.Tx)();case 3:return c=e.sent,u=(0,l.A)(t,ze)[ze]({mainCheckAction:c,form:a,instAction:s,direction:i,buttonItem:[],fields:r}),e.abrupt("return",u);case 6:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}(),(0,ee.Tx)(),(0,ee.XG)(),(0,ee.YT)(),this.needChangeNewPlaceOrderReaction=(0,v.reaction)((function(){return he.A.needChangeNewPlaceOrder}),(function(e){e||t.linesAndPriceAction||(t.linesAndPriceAction=new fe.A({onPriceUpdate:t.onPriceUpdate.bind(t),getPriceFormFields:t.getPriceFormFields.bind(t),isBuySellMode:!1,updateAvailable:t.updateAvailable.bind(t)}),t.orderTypeReaction=(0,v.reaction)((function(){return he.A.orderType}),(function(e){t.linesAndPriceAction.setOrderType(e)}),{fireImmediately:!0}))}),{fireImmediately:!0}),this.linesClearReaction=(0,v.reaction)((function(){return{instId:g.A.instId,instType:g.A.instType}}),(function(){var e;null===(e=t.linesAndPriceAction)||void 0===e||e.clearLinesAndCache()})),this.unitChangeReaction=(0,v.reaction)((function(){var e;return null===g.A||void 0===g.A||null===(e=g.A.config)||void 0===e?void 0:e.unitName}),(function(e,t){if((null===g.A||void 0===g.A?void 0:g.A.instStatus).isFuturesOrSwap&&e!==t){var i,r=be.A.instAction,n=null===r||void 0===r||null===(i=r.store)||void 0===i?void 0:i.selectCostSizeType;null!==r&&void 0!==r&&r.clearSizeAndPercent&&!n&&(r.clearSizeAndPercent("left"),r.clearSizeAndPercent("right"))}}),{fireImmediately:!1})}),[{key:"updateAvailable",value:function(){be.A.getMaxAvail({instId:g.A.instId})}},{key:"innerClearInputError",value:function(e){var t=e.key,i=e.direction,r=be.A.instAction,n=null===r||void 0===r?void 0:r.store;if(n){var o=n["".concat(i,"Form")],s=(0,a.A)({},o.inputErrors);s[t]="",(0,ge.Oi)({value:s,direction:i,instAction:r})}}},{key:"innerShowSubmitConfirm",value:function(){var e=(0,s.A)((0,o.A)().mark((function e(t){var i,r,a,s,c,u,l,d,v,p,f,A,h,y,k,_,P,b,T,w,I,x,S=this;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.direction,a=t.buttonItem,s=(0,n.A)(t,Ce),c=be.A.instAction,u=this.getDirectionForm(r),l=u.form,d=void 0===l?{}:l,v=g.A.instStatus,p=he.A.accountStatus,f=this.getTransferInfo({isFullPercent:s.isFullPercent,direction:r,form:d}),A=this.buildPostOrderData({direction:r,buttonItem:a,submitData:s,borrowInfo:f}),e.prev=7,h=(null===c||void 0===c?void 0:c.store)||{},y=h.liqPxBuySize,k=h.liqPxSellSize,_=h.leftLiquidationPrice,P=h.rightLiquidationPrice,!("left"===r&&null!==_&&void 0!==_&&_.showLiqPx||"right"===r&&null!==P&&void 0!==P&&P.showLiqPx)){e.next=14;break}return b=A.side,T=A.slTriggerPx,w=A.attachAlgoOrds,I=b===Me,e.next=14,(0,C.r)({slTriggerPx:T||(1===(null===w||void 0===w?void 0:w.length)?w[0].slTriggerPx:""),liqPx:I?y:k,isLong:I});case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(7),e.abrupt("return");case 19:if(x=this.shouldSkipConfirmation({accountStatus:p,instStatus:v,buttonItem:a}),he.A.updateByKey("postOrderData",A),x||!m.A.isOrderConfirm){e.next=27;break}return e.next=24,(0,ee.XG)();case 24:return e.sent.onOpenConfirm({form:d,postOrderData:A,buttonItem:a,callbackAfterPostOrder:function(){var e;null===(e=S.linesAndPriceAction)||void 0===e||e.clearLinesAndCache()}}),e.abrupt("return");case 27:X.default.doPostOrder(),null===(i=this.linesAndPriceAction)||void 0===i||i.clearLinesAndCache();case 29:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"buildPostOrderData",value:function(e){var t,i=e.direction,r=e.buttonItem,n=e.submitData,o=e.borrowInfo,s=(0,a.A)((0,a.A)({direction:i,buttonType:r.type},(0,ue.wH)()),n);return((null===(t=be.A.instAction)||void 0===t?void 0:t.store)||{}).showAvailSourceFunding&&Object.assign(s,o),s}},{key:"shouldSkipConfirmation",value:function(e){var t=e.accountStatus,i=e.instStatus,r=e.buttonItem;return t.isTrade&&i.isOption&&r.side===Oe}},{key:"getTransferInfo",value:function(e){var t=e.isFullPercent,i=e.direction,r=e.form,n=be.A.instAction,o=null===n||void 0===n?void 0:n.store,a=r.size,s=void 0===a?0:a,c=r.price,u=void 0===c?0:c,l=r.total,d=void 0===l?0:l,v=r.totalLabelSelected,p=null===o||void 0===o?void 0:o[S.Cs],f=(null===o||void 0===o?void 0:o["".concat(i,"AvailRes")])||{},A=f||{},h=A.available,g=void 0===h?0:h,m=A.loanAvailable,y=void 0===m?0:m,k=A.threshold,_="left"===i,P=(0,b.M0)(g,this.getSubtrahend(y)),T=this.getOrderValue({price:u,size:s,isBuy:_,totalLabelSelected:v,total:d,threshold:k}),C=this.getTransferFundsAndEarnedCoins({accountCheckedInitValues:p,availRes:f,form:r,availableValue:P,isBuy:_,isFullPercent:t}),w=C.fundTransferAmount,I=C.earnedCoinTransferAmount;return{assetNeedTransfer:Ie(w,0)?w:void 0,simpleEarnNeedTransfer:Ie(I,0)?I:void 0,tradeAvail:Ie(P,0)?P:void 0,orderValue:T}}},{key:"getOrderValuePrecision",value:function(e){return Ie(e,0)?xe(e,T.Md):void 0}},{key:"getOrderValue",value:function(e){var t,i=e.price,r=e.size,n=e.isBuy,o=e.totalLabelSelected,a=e.total,s=e.threshold,c=he.A.orderTypeStatus.isMarket,u=ve.A.ticker,l=u.bidPx,d=u.askPx;return c&&n&&(null===o||void 0===o?void 0:o.value)===Le?t=this.getOrderValuePrecision((0,b.yB)((0,b.yB)(d||0,r),(0,b.Lg)(1,s))):c&&!n&&(null===o||void 0===o?void 0:o.value)===Se?t=this.getOrderValuePrecision((0,b.vu)((0,b.vu)(a,l||0),(0,b.M0)(1,s))):n?t=this.getOrderValuePrecision((0,b.yB)(i,r)):n||(t=r),t}},{key:"getTransferFundsAndEarnedCoins",value:function(e){var t,i=e.accountCheckedInitValues,r=void 0===i?{}:i,n=e.availRes,o=e.form,a=e.availableValue,s=e.isBuy,c=e.isFullPercent,u=he.A.accountStatus,l=he.A.orderTypeStatus,d=he.A.quotePrecision,v=he.A.sizePrecision,p=u.isTrade,f=l.isAlgoType,A=l.isMarket,h=l.isLimit,g=l.isAdv,m=o.totalLabelSelected,y=void 0===m?{}:m,k=o.size,_=o.total,P=o.price,b=(null===(t=be.A.instAction)||void 0===t?void 0:t.store)||{},T=n.assetAvail,C=n.simpleEarnAvail,w=n.threshold,I=ve.A.ticker,x=I.bidPx,S=I.askPx;return!p||f||b.showSimpleBorrowAmount||!r.isAssetAccountChecked&&!r.isEarnAccountChecked?this.getDefaultTransferAmounts():c?this.getFullPercentTransferAmounts(r,T,C):h||g?this.handleLimitOrAdvOrder({isBuy:s,accountCheckedInitValues:r,assetAvail:T,simpleEarnAvail:C,price:P,size:k,availableValue:a,quotePrecision:d,sizePrecision:v}):A?this.handleMarketOrder({isBuy:s,totalLabelSelected:y,accountCheckedInitValues:r,assetAvail:T,simpleEarnAvail:C,threshold:w,size:k,total:_,availableValue:a,quotePrecision:d,sizePrecision:v,bidPx:x,askPx:S}):this.getDefaultTransferAmounts()}},{key:"getDefaultTransferAmounts",value:function(){return{fundTransferAmount:0,earnedCoinTransferAmount:0}}},{key:"getFullPercentTransferAmounts",value:function(e,t,i){return{fundTransferAmount:e.isAssetAccountChecked?t:0,earnedCoinTransferAmount:e.isEarnAccountChecked?i:0}}},{key:"handleLimitOrAdvOrder",value:function(e){var t=e.isBuy,i=e.accountCheckedInitValues,r=e.assetAvail,n=e.simpleEarnAvail,o=e.price,a=e.size,s=e.availableValue,c=e.quotePrecision,u=e.sizePrecision;return t?(0,T.wp)({accountCheckedInitValues:i,assetAvail:r,simpleEarnAvail:n,price:o,size:a,availableValue:s,quotePrecision:c}):(0,T.JB)({accountCheckedInitValues:i,assetAvail:r,simpleEarnAvail:n,size:a,availableValue:s,sizePrecision:u})}},{key:"handleMarketOrder",value:function(e){var t=e.isBuy,i=e.totalLabelSelected,r=e.accountCheckedInitValues,n=e.assetAvail,o=e.simpleEarnAvail,a=e.threshold,s=e.size,c=e.total,u=e.availableValue,l=e.quotePrecision,d=e.sizePrecision,v=e.bidPx,p=e.askPx;if(t)switch(null===i||void 0===i?void 0:i.value){case Se:return(0,T.X4)({accountCheckedInitValues:r,assetAvail:n,simpleEarnAvail:o,total:c,availableValue:u,quotePrecision:l});case Le:return(0,T.Ou)({accountCheckedInitValues:r,assetAvail:n,simpleEarnAvail:o,threshold:a,price:p,size:s,availableValue:u,quotePrecision:l});default:return this.getDefaultTransferAmounts()}else switch(null===i||void 0===i?void 0:i.value){case Le:return(0,T.JB)({accountCheckedInitValues:r,assetAvail:n,simpleEarnAvail:o,size:s,availableValue:u,sizePrecision:d});case Se:return(0,T.pQ)({accountCheckedInitValues:r,assetAvail:n,simpleEarnAvail:o,threshold:a,price:v,total:c,availableValue:u,sizePrecision:d});default:return this.getDefaultTransferAmounts()}}},{key:"getSubtrahend",value:function(e){return e||0}},{key:"updateForm",value:function(e){var t=this;return function(i,r){var n,o,a;t.innerClearInputError({key:i,direction:e}),"bboChecked"===i&&r&&(t.innerClearInputError({key:"price",direction:e}),g.A.instStatus.isFuturesOrSwap&&we.init(),(0,K.rSC)({button_status:r?"on":"off",biz_type:g.A.instType})),"bboChecked"!==i||r||g.A.instStatus.isFuturesOrSwap&&we.destroy(),"bboType"===i&&(0,K.aB5)({biz_type:g.A.instType,bbo_type:r.value}),"percent"===i&&(t.innerClearInputError({key:"size",direction:e}),t.innerClearInputError({key:"costSize",direction:e}),t.innerClearInputError({key:"total",direction:e})),null===(n=X.default.instAction)||void 0===n||n.updateForm({key:i,value:r,direction:e}),null===(o=t.linesAndPriceAction)||void 0===o||o.checkClearLinesAndCache({key:i,direction:e}),null===(a=t.linesAndPriceAction)||void 0===a||a.checkDrawPreviewLines({direction:e,key:i})}}},{key:"onInputBlur",value:function(e){return function(t,i){var r;null===(r=X.default.instAction)||void 0===r||r.onInputBlur({key:t,value:i,direction:e})}}},{key:"onSwitchOrderType",value:function(e){var t,i=X.default.instAction;null===i||void 0===i||i.onSwitchOrderType(e),(0,ge.DN)({direction:"left",instAction:i}),(0,ge.DN)({direction:"right",instAction:i}),null===(t=this.linesAndPriceAction)||void 0===t||t.clearLinesAndCache(),this.checkReminder(e)}},{key:"checkReminder",value:function(e){var t=m.A.copyInfo,i=(0,w.m)(g.A.instId,t),r=pe.A.positionTypeStatus.isNetMode&&g.A.instStatus.isFuturesOrSwap,n=[{needRemind:e===Be&&!f.A.get(S.RT)&&r,msgLocale:"spot_placeorder_modal_reminder_desc_stop_net",storageKey:S.RT},{needRemind:e===Be&&!f.A.get(S.lN)&&!r,msgLocale:"spot_placeorder_modal_reminder_desc_stoporder",storageKey:S.lN},{needRemind:e===Fe&&!f.A.get(S.pS),msgLocale:"spot_placeorder_modal_reminder_trigger_desc",storageKey:S.pS},{needRemind:!!i&&e===De&&!f.A.get(S.r0),msgLocale:"trade_placeorder_toast_lead_trader_fail_offset_cont",storageKey:S.r0}].find((function(e){return e.needRemind}));if(n){var o=n.msgLocale,a=n.storageKey;!function(e){var t=e.title,i=void 0===t?(0,A.kW)("spot_placeorder_modal_reminder_title"):t,r=e.desc,n=void 0===r?"":r,o=e.confirmText,a=void 0===o?(0,A.kW)("spot_placeorder_modal_reminder_coinfirm_btn"):o,s=e.onClose,c=void 0===s?oe.x7:s,u=!1,l=ne.A.action({title:i,width:392,hideCloseBtn:!0,noContentPadding:!1,confirmText:a,children:(0,ae.jsxs)("div",{className:"place-order-reminder-dialog-box",children:[(0,ae.jsx)("p",{children:n}),(0,ae.jsx)(se,{afterChange:function(e){u=e}})]}),onConfirm:function(){c(u),l.destroy()}})}({desc:(0,A.kW)(o),onClose:this.onCloseConfirmWithCheck(a)})}}},{key:"runBury",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t=g.A.instId,i=g.A.instType,r=he.A.orderType,n=he.A.baseTradeMode,o=e.direction,a=e.form,s=a.size,c=a.price,u=a.isReduceOnly,l=a.slTriggerPx,d=a.tpTriggerPx,v=a.tpOrdPx,p=a.advType,f=a.algoType,A=a.triggerPriceType,h=a.tpTriggerPriceType,m=a.slTriggerPriceType;!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(Y.A||{}).site,i=(void 0===t?{}:t).sign,r=void 0===i?"okex":i;G().newInstance({site:r.toLocaleLowerCase(),product:"pm",commonParams:{mode:(0,I.yI)()?"demo":"live"}}).act({action:"web_trade",anchor:"web_trade",params:e,actionType:"",elementType:"",extras:{isSyncAMP:!1}})}({instId:t,instType:i,ordType:r,side:"left"===o?Me:Oe,sz:s,px:c,reduceOnly:u,slTriggerPx:l,tpTriggerPx:d,tpOrdPx:v,advType:p,algoType:f,slTriggerPxType:m||A,tpTriggerPxType:h||A,tdMode:n})}catch(y){}}},{key:"onClearError",value:function(e){return function(){var t;null===(t=X.default.instAction)||void 0===t||t.updateForm({key:"formErrorMsg",value:"",direction:e})}}},{key:"changePostType",value:function(e){var t,i;he.A.updateByKey("postType",e),null===(t=X.default.instAction)||void 0===t||t.changePostType(e),null===(i=this.linesAndPriceAction)||void 0===i||i.clearLinesAndCache()}},{key:"onInputFocus",value:function(e){var t=this;return function(i){var r,n;null===(r=t.linesAndPriceAction)||void 0===r||r.onInputFocus(e,i),null===(n=X.default.instAction)||void 0===n||n.onInputFocus({key:i,direction:e})}}},{key:"onAddSubPrice",value:function(e){return(0,h.A)((function(t,i){var r;null===(r=X.default.instAction)||void 0===r||r.onInputBlur({key:"price",value:t,direction:e}),(0,K.ZpY)({button_type:i})}),500)}},{key:"onLabelSelectedChange",value:function(e){return function(t,i){var r;null===(r=X.default.instAction)||void 0===r||r.onLabelSelectedChange({key:t,value:i,direction:e})}}},{key:"innerGetSportOrMarginLeverConfig",value:function(e){if(g.A.instStatus.isSpotOrMargin){var t,i="left"===e,r=null===(t=be.A.instAction)||void 0===t?void 0:t.store;return(0,ce.k)({mainStore:he.A,store:r,isBuy:i})}return{}}},{key:"changeTradeMode",value:function(e){var t;be.A.changeTradeMode(e),be.A.resetOrderType(),null===(t=this.linesAndPriceAction)||void 0===t||t.clearLinesAndCache()}},{key:"getTransferCoin",value:function(e){var t=g.A.instStatus,i=g.A.inst,r=t.isSpotOrMargin,n=i.settleCcy;if(r){var o="left"===e,a=he.A.isSolidMargin,s=he.A.base,c=he.A.quote;if(n=o?c:s,a){var u,l=null===(u=be.A.instAction)||void 0===u?void 0:u.store;if(l)n=l["".concat(e,"FormDisp")].ccy||c}}return n}},{key:"onClickTransfer",value:function(e){var t=this;return function(){if((0,M._p)()){var r=t.getTransferCoin(e),n=(g.A.coins[r]||{}).id,o=[{currencyId:Number(n),currency:r}];Promise.all([i.e("vendors-node_modules_ok_okd_components_Animation_SvgAnimation_js"),i.e("vendors-node_modules_ok_okd_components_Animation_index_less-node_modules_ok_okd_components_Re-f4767f"),i.e("vendors-node_modules_ok_experiment-js-client_dist_experiment_umd_js-node_modules_ok_okd_compo-812c4c"),i.e("vendors-node_modules_ok_blade_lib_web-storage_src_LS_js-node_modules_ok_blade_lib_web-storage-975cbe"),i.e("vendors-node_modules_fuse_js_dist_fuse_mjs"),i.e("@ok-Transfer")]).then(i.bind(i,13532)).then((function(e){var t=e.OKTransfer,i=e.TransferAccount,r=i.ID_WALLET,n=i.ID_UNIFIED;t.show({fromId:r,toId:n,canProductChange:!0,canCurrencyChange:!0,currencyList:o,closeCallback:function(){},successCallback:function(){be.A.getMaxAvail()}})})).catch((function(){}))}}}},{key:"onClickVipBorrow",value:function(e){var t=this;return(0,s.A)((0,o.A)().mark((function i(){var r,n;return(0,o.A)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((0,M._p)()){i.next=2;break}return i.abrupt("return");case 2:return r=t.getTransferCoin(e),n=be.A.getMaxAvail,i.next=6,(0,P.e)({ccy:r,callback:n});case 6:case"end":return i.stop()}}),i)})))}},{key:"onChangeSizeType",value:function(){return function(e){var t=be.A.instAction;null===t||void 0===t||t.onChangeSizeType(e)}}},{key:"onAvailChange",value:function(e){return function(t){var i=be.A.instAction;null===i||void 0===i||i.onAvailChange((0,a.A)((0,a.A)({},t),{},{direction:e}))}}},{key:"onAccountCheckedChange",value:function(){return function(e){var t=be.A.instAction;null===t||void 0===t||t.onAccountCheckedChange({changeResult:e})}}},{key:"onPriceUpdate",value:function(e,t,i){this.updateForm(e)(t,i)}},{key:"destroy",value:function(){var e,t,i,r,n;null===(e=this.linesAndPriceAction)||void 0===e||e.destroy(),null===(t=this.linesClearReaction)||void 0===t||t.call(this),null===(i=this.orderTypeReaction)||void 0===i||i.call(this),null===(r=this.needChangeNewPlaceOrderReaction)||void 0===r||r.call(this),null===(n=this.unitChangeReaction)||void 0===n||n.call(this)}}])}())},21217:(e,t,i)=>{i.d(t,{A:()=>k});var r=i(90675),n=i(10467),o=i(92901),a=i(23029),s=i(4536),c=i(30631),u=i(75376),l=i(21166),d=i(73267),v=i(42182),p=i(28494),f=i(81707),A=i(63510),h=i(65555),g=i(93121),m=i(8786),y=i(49313);const k=new((0,o.A)((function e(){var t=this;(0,a.A)(this,e),this.onQuickMarginChange=function(e){f.A.update({quickMgnType:e}),y.default.getMax()},this.checkIfIsTrade=function(){var e=g.A.accountLevelStatus.isTrade;return e&&(m.A.closeSmPlaceOrder(),h.A.openAccountLevelDrawer()),e},this.onClickTransfer=function(){t.checkIfIsTrade()||t.openTransferDialog()},this.onClickTransferInAvail=function(e){t.checkIfIsTrade()||d.A.show(e)},this.checkOnClickSubmit=(0,n.A)((0,r.A)().mark((function e(){var i;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.A.isQuickMargin){e.next=3;break}return e.abrupt("return",!0);case 3:if(!t.checkingCanBorrow){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,t.checkIfCanBorrow();case 7:return(i=e.sent)||t.showTransferAlert(),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)}))),this.onClickBorrow=(0,n.A)((0,r.A)().mark((function e(){return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.checkingCanBorrow){e.next=2;break}return e.abrupt("return");case 2:if(!t.checkIfIsTrade()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t.checkIfCanBorrow();case 6:if(e.sent){e.next=10;break}return t.showTransferAlert(),e.abrupt("return");case 10:t.openBorrowRepayDialog();case 11:case"end":return e.stop()}}),e)}))),this.onTransferAlertConfirm=function(){t.transferAlertDialog.destroy(),t.openTransferDialog()},this.showTransferAlert=function(){t.transferAlertDialog=c.A.warn({title:(0,s.kW)("trade_transfer_toast_title_need_collateral"),text:(0,s.kW)("trade_transfer_toast_content_need_collateral"),confirmText:(0,s.kW)("trade_setting_button_auto_dialog_transfer"),cancelText:(0,s.kW)("options_buyoptions_modal_btn_cancel"),onConfirm:t.onTransferAlertConfirm})},this.openTransferDialog=function(){var e=u.A.instId;d.A.show({instId:e})},this.openBorrowRepayDialog=function(){var e=u.A.instId;l.A.show({instId:e})},this.checkIfCanBorrow=(0,n.A)((0,r.A)().mark((function e(){var i,n,o,a;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.checkingCanBorrow=!0,i=u.A.instId,e.next=5,A.A.getPositions({instId:i});case 5:return n=e.sent,o=n.data,a=o.find((function(e){return e.mgnMode===p.Tn.ISOLATED})),e.abrupt("return",!(!a||!(+a.baseBal>0||+a.quoteBal>0)));case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",!0);case 14:return e.prev=14,t.checkingCanBorrow=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])}))),this.checkingCanBorrow=!1,this.transferAlertDialog={destroy:v.x7}})))},64760:(e,t,i)=>{i.d(t,{k:()=>s,l:()=>a});var r=i(25594),n=r.g2.BUY,o=r.g2.SELL,a=function(e){var t=e.lever,i=e.side,r=e.instStore,n=e.mainStore;return{instType:r.instType,instId:r.instId,lever:t,posSide:i,mgnMode:n.tradeMode}},s=function(e){var t,i=e.mainStore,r=e.store,a=e.isBuy,s=i.base,c=i.quote,u=i.isAccountMultiCross,l=a?n:o;if(u)l=a?o:n,t=a?c:s;else if(r){t=(a?r.leftForm:r.rightForm).ccy}return{requireMargin:t,posSide:l}}},88632:(e,t,i)=>{i.d(t,{$u:()=>b,IH:()=>E,NX:()=>T,Nn:()=>w,PK:()=>F,_i:()=>L,cd:()=>O,es:()=>D,iu:()=>C,iv:()=>x,nq:()=>I,qL:()=>B,s4:()=>M});var r=i(89379),n=i(60436),o=i(5544),a=i(71491),s=i(48705),c=i(75376),u=i(42182),l=i(28494),d=i(25594),v=i(94779),p=i(81707),f=i(37964),A=i(52711),h=i(48478),g=l.LT.SIZE_BASE,m=l.LT.PRICE_QUOTE,y=l.o6.BASE_CCY,k=l.o6.QUOTE_CCY,_=d.W4.MARKET,P=function(e){return s.Et(e)&&Number(e)>0},b=function(e){var t=e.form,i=e.isBuy,r=v.A.quotePrecision,n=v.A.sizePrecision,o=v.A.orderTypeStatus,s=v.A.showTotalLabelSelect,c=t.price,u=t.size,l=t.total,d=t.totalLabelSelected,p=null===d||void 0===d?void 0:d.value,f=s&&p===m,A=s&&p===g;""===c?t.total="":i&&o.isMarket||!u||f?l&&!A&&(t.size=a._u.floorDiv(l,c,n,!1)):t.total=a._u.ceilMul(c,u,r,!1)},T=function(e){var t=e.form,i=v.A.quotePrecision,r=t.price,n=t.size;""===n?t.total="":r&&(t.total=a._u.ceilMul(r,n,i,!1))},C=function(e){var t=e.form,i=v.A.sizePrecision,r=t.price,n=t.total;""===n?t.size="":r&&(t.size=a._u.floorDiv(n,r,i,!1))},w=function(e){var t=e.value,i=e.isBuy,r=e.form,n=e.formName,s=v.A.quotePrecision,c=v.A.sizePrecision,u=v.A.showTotalLabelSelect,l=f.Ay.maxBalances,d=f.Ay.isMarketOnlySpot,p=f.Ay.maxBuyAndSell,A=(0,o.A)(l,2),h=A[0],g=A[1],m=(0,o.A)(p,2),y=m[0],k=m[1],_=r.price;if(t!==f.Ay[n].percent){var b=0;if(_){if(i&&P(g)){b=r.percent;var T=a._u.mul(g,a._u.div(b,100));r.total=a._u.floorTruncate(T,s,!1),r.size=d?a._u.floorMul(y,a._u.div(b,100),c,!1):a._u.floorDiv(T,_,c,!1)}if(!i&&P(h)){b=r.percent;var C=a._u.mul(h,a._u.div(b,100));r.size=a._u.floorTruncate(C,c,!1),r.total=d?a._u.floorMul(k,a._u.div(b,100),c,s):a._u.floorMul(_,C,s,!1)}}r.percent=t,u&&(r.percentWithChangeSlider=!0),0===b&&(r.total="",r.size="")}},I=function(e){var t=e.value,i=e.balance,r=0;return t&&i&&(r=a._u.ceilDiv(a._u.mul(t,100),i,0)),Math.min(100,Number(r))},x=function(e){var t=e.form,i=e.percent,r=e.showAlgoTotal,n=e.quoteBalance,o=e.sizeBalance,s=v.A.quotePrecision,c=v.A.sizePrecision,u=v.A.showTotalLabelSelect,l=!1;if(r&&P(n)){l=!0;var d=a._u.mul(n,a._u.div(i,100));t.total=a._u.floorTruncate(d,s,!1)}if(!r&&P(o)){l=!0;var p=a._u.mul(o,a._u.div(i,100));t.size=a._u.floorTruncate(p,c,!1)}t.percent=i,u&&(t.percentWithChangeSlider=!0),0!==i&&l||(t.total="",t.size="")},S=function(e,t,i){return e?t:i},L=function(e){!function(e){var t,i,r=e.res,o=void 0===r?{}:r,s=e.param,c=e.isBuy,u=e.cvtMaxAvailable,l=e.cvtMaxTrades,d=v.A.isSolidMargin,A=v.A.isolatedAutoTransferMode,h=v.A.isolatedAutoTransferModeBySpot,g=p.A.isQuickMargin,m=o.available,y=o.px,k=f.Ay.leftAvailRes,_=f.Ay.rightAvailRes,P=(0,n.A)(f.Ay.maxBuyAndSell),b=(0,n.A)(f.Ay.reduceOnlyBals),T=(0,n.A)(f.Ay.maxBalances),C=(0,n.A)(f.Ay.avails);c?k=o:_=o;var w=null===u||void 0===u||null===(t=u[0])||void 0===t?void 0:t.value,I=null===l||void 0===l||null===(i=l[0])||void 0===i?void 0:i.value;g&&(I=S(c,a._u.div(m,y),m));var x=S(c,1,0),L=S(c,0,1);P[L]=I,T[x]=w,s.reduceOnly?b[x]=w:(C[L]=w,!d||A||h||g||(T[x]=S(c,a._u.mul(y,I),I))),f.Ay.update({maxBuyAndSell:P,reduceOnlyBals:b,avails:C,maxBalances:T,leftAvailRes:k,rightAvailRes:_})}({res:e.res,param:e.param,isBuy:e.isBuy,form:e.form,cvtMaxAvailable:e.cvtMaxAvailable,cvtMaxTrades:e.cvtMaxTrades})},M=function(e){var t=e.form,i=e.isBuy,r=v.A.showTotalLabelSelect,n=v.A.orderTypeStatus,o=n.isMarket,a=n.isStop,s=t.size,c=t.total,u=t.totalLabelSelected;return o&&r||a&&h.A.getAlgoTotalLabelVisibility({mainStore:v.A,form:t,isLeft:i})?(null===u||void 0===u?void 0:u.value)===m?c:s:i?c:s},O=function(e){var t;return(null===(t=e.totalLabelSelected)||void 0===t?void 0:t.value)===g?y:k},B=function(e){var t=e.res,i=e.direction,n=e.param,o="",a="",s="".concat(i,"Form"),c=f.Ay[s];v.A.showLoanAmount&&n.sz&&(o=t.changeDebt,a=t.changeDebtCcy);var u=(0,r.A)((0,r.A)({},c),{},{loanAmount:o,loanUnit:a});f.Ay.updateByKey(s,u)},F=function(e){var t=e.form,i=e.direction,r=t.size,n="left"===i;return function(e){var t=v.A.orderTypeStatus,i=t.isMarket,r=t.isStop,n=t.isTrigger,o=e.algoType,a=e.orderPrice,s=e.tpOrderPrice,c=e.slOrderPrice;return!!i||(r&&o===d.Mw.CONDITIONAL||n?(0,h._)(a):!(!r||o!==d.Mw.OCO)&&(0,h._)(s)&&(0,h._)(c))}(t)?M({form:t,isBuy:n}):r},D=function(e){var t=e.form,i=e.direction,r=f.Ay.showSimpleBorrowAmount,n=f.Ay.showSimpleBorrowRepayAmount,o=F({form:t,direction:i});if(!r&&!n&&!v.A.showLoanAmount&&!v.A.showQuickMarginBorrowRepay||A.A.numIsEmpty(o))return u.t0;var s={sz:a._u.toPlainString(o)},l=v.A.showTotalLabelSelect,d=v.A.orderTypeStatus,p=d.isMarket,g=d.isStop,m="left"===i;if(p)s.ordType=_,l&&(s.tgtCcy=O(t));else if(g&&h.A.getAlgoTotalLabelVisibility({mainStore:v.A,form:t,isLeft:m})){var y=O(t);s.tgtCcy=y,y===k&&(s.ordType=_)}else h.A.getNormalAlgoTotalVisibility({mainStore:v.A,instStatus:c.A.instStatus,isLeft:m,form:t})&&(s.tgtCcy=k,s.ordType=_);return s},E=function(e){var t=e.formName,i=e.key,n=["size","total","percent"].includes(i),o=f.Ay[t],a=A.A.numIsEmpty(o.size),s=v.A.showLoanAmount,c=v.A.showQuickMarginBorrowRepay,u=s&&n;if(u&&a){var l=(0,r.A)((0,r.A)({},o),{},{loanAmount:"",loanUnit:""});f.Ay.updateByKey(t,l)}var d=c&&n,p=(f.Ay.showSimpleBorrowAmount||f.Ay.showSimpleBorrowRepayAmount)&&n;return u&&!a||d||p}}}]);
//# sourceMappingURL=https://static-daily.okg.com/crash/okfe/comb-trade/src_common_bizComps_LeadTraderRiskConfirm_action_js-src_common_pages_trade_modules_PlaceOrder-0f6a24/index.bcd31b4f.js.map