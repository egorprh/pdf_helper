"use strict";(self.webpackChunkcomb_trade=self.webpackChunkcomb_trade||[]).push([["src_common_bizComps_QuickMargin_BorrowRepay_actions_openAction_js-src_common_bizComps_QuickMa-48644e"],{1294:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(90675),r=n(10467),o=n(92901),i=n(23029),s=n(71491),c=n(75627),u=n(63510),l=n(59169),d=n(49878),_=n(8624);const m=new((0,o.A)((function e(){var t=this;(0,i.A)(this,e),this.init=function(){return t.fetchAmount(),t.destroy},this.destroy=function(){t.clearInputAndAvailData()},this.clearInputAndAvailData=function(){t.changeData({amt:"",percent:0,balanceAmount:0,borrowed:0,orderLoanAmount:0,interestRate:0,interest:0,repayAvailAmount:0})},this.fetchAmount=(0,r.A)((0,a.A)().mark((function e(){var n,r,o,i,s,_,m,A,p,h,b,v;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.Ei)()){e.next=2;break}return e.abrupt("return");case 2:return t.clearInputAndAvailData(),n=d.A.side,r=d.A.ccy,o=d.A.isBorrow,i=d.A.instId,s={instId:i,side:n,ccy:r},e.prev=5,e.next=8,u.A.getBorrowRepayInfo(s);case 8:_=e.sent,m=_.balanceAmount,A=_.borrowed,p=_.orderLoanAmount,h=_.interestRate,b=_.repayAvailAmount,v=_.interest,o?t.changeData({balanceAmount:m,borrowed:A,orderLoanAmount:p,interestRate:h}):t.changeData({borrowed:A,repayAvailAmount:b,interest:v}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),(0,l.Z2)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[5,18]])}))),this.onTypeChange=function(e){t.changeData({side:e}),t.fetchAmount()},this.onCcyChange=function(e){t.changeData({ccy:e}),t.fetchAmount()},this.onPercentChange=function(e){t.changeData({percent:e});var n=s._u.mul(d.A.availNum,d.A.percentValue);t.changeData({amt:n})},this.onAmtChange=function(e){var n=0,a="",r=d.A.availNum,o=d.A.isBorrow;if(e){a=e>r?r:e;var i=s._u.div(a,r);n=s._u.floorTruncate(s._u.mul(i,100),0)}var c=o?a:e;t.changeData({amt:c,percent:n})},this.changeData=function(e){if(d.A.update(e),(0,c.Ei)()){var t=d.A.amt,n=!Number(t);_.A.update({confirmDisabled:n})}},this.onClickConfirm=(0,r.A)((0,a.A)().mark((function e(){var t,n,r,o,i;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,c.Ei)()){e.next=2;break}return e.abrupt("return",Promise.reject());case 2:return t=d.A.side,n=d.A.amt,r=d.A.ccy,o=d.A.instId,i={side:t,ccy:r,instId:o,amt:s._u.toPlainString(n)},e.prev=4,e.next=7,u.A.postBorrowRepay(i);case 7:return _.A.destroy(),e.abrupt("return",Promise.resolve());case 11:return e.prev=11,e.t0=e.catch(4),(0,l.Z2)(e.t0),e.abrupt("return",Promise.reject());case 15:case"end":return e.stop()}}),e,null,[[4,11]])})))})))},21166:(e,t,n)=>{n.d(t,{A:()=>g});var a=n(89379),r=n(5544),o=n(92901),i=n(23029),s=n(41594),c=n(30631),u=n(4536),l=n(53627),d=n(89347),_=n(41140),m=n(57628),A=n(31486),p=n(49878),h=n(19919),b=(0,s.lazy)((function(){return Promise.all([n.e("vendors-node_modules_ok_okd_components_Slider_index_js"),n.e("vendors-node_modules_ok_okd_components_Radio_index_less-node_modules_ok_okd_components_Slider-d8155b"),n.e("QuickMarginBorrowRepayBody")]).then(n.bind(n,60607))}));const v=(0,_.observer)((function(){var e=p.A.bodyMinHeight;return(0,h.jsx)("div",{className:A.A.container,style:{minHeight:e},children:(0,h.jsx)(s.Suspense,{fallback:(0,h.jsx)(m.A,{}),children:(0,h.jsx)(b,{})})})}));var f=n(8624),y=n(1294),k=l.im.BORROW;const g=new((0,o.A)((function e(){var t=this;(0,i.A)(this,e),this.getInitProps=function(e){var t=e.instId,n=e.ccy,a=e.side,o=t.split("-"),i=(0,r.A)(o,1)[0];return{instId:t,ccy:n||i,side:a}},this.show=function(e){var n=e.instId,r=e.ccy,o=e.side,i=void 0===o?k:o,s=t.getInitProps({instId:n,ccy:r,side:i});y.A.changeData(s);var l=(0,d.v)(f.A);f.A.instance=c.A.action((0,a.A)({title:(0,u.kW)("trade_borrow_modal_title_borrow_repay"),children:(0,h.jsx)(v,{}),onConfirm:y.A.onClickConfirm},l))}})))},49878:(e,t,n)=>{n.d(t,{A:()=>A});var a=n(23029),r=n(92901),o=n(39874),i=n(85501),s=n(44497),c=n(4536),u=n(71491),l=n(53627),d=n(67530),_=l.im.BORROW,m=l.im.REPAY;const A=new(function(e){function t(){var e;return(0,a.A)(this,t),(e=(0,o.A)(this,t)).side=_,e.balanceAmount=0,e.borrowed=0,e.orderLoanAmount=0,e.interestRate=0,e.repayAvailAmount=0,e.interest=0,e.tabs=[{id:_,tab:(0,c.kW)("trade_borrow_modal_tab_manual_borrow")},{id:m,tab:(0,c.kW)("trade_borrow_modal_tab_manual_repay")}],e.ccyTitle=(0,c.kW)("trade_borrow_modal_label_select_crypto"),(0,s.makeObservable)(e,{side:s.observable,typeId:s.computed,balanceAmount:s.observable,borrowed:s.observable,orderLoanAmount:s.observable,interestRate:s.observable,repayAvailAmount:s.observable,interest:s.observable,isBorrow:s.computed,bodyMinHeight:s.computed,availNum:s.computed,inputTitle:s.computed,availNumList:s.computed,maxRepayAmount:s.computed}),e}return(0,i.A)(t,e),(0,r.A)(t,[{key:"typeId",get:function(){return this.side}},{key:"isBorrow",get:function(){return this.side===_}},{key:"bodyMinHeight",get:function(){return this.isBorrow?354:334}},{key:"maxRepayAmount",get:function(){var e=this.borrowed,t=this.interest,n=this.digit,a=this.repayAvailAmount,r=u._u.ceilTruncate(e||0,n),o=u._u.ceilTruncate(t||0,n),i=u._u.ceilTruncate(a||0,n),s=u._u.add(r,o);return Math.min(+i,+s)}},{key:"availNum",get:function(){var e=this.balanceAmount,t=this.maxRepayAmount,n=this.isBorrow;return Number(n?e:t)}},{key:"inputTitle",get:function(){return"".concat((0,c.kW)("trade_borrow_modal_label_amount")," (").concat(this.ccy,")")}},{key:"availNumList",get:function(){var e=this.isBorrow,t=this.balanceAmount,n=this.borrowed,a=this.orderLoanAmount,r=this.interestRate,o=this.repayAvailAmount,i=this.interest;return e?[{label:(0,c.kW)("trade_borrow_modal_label_can_borrow"),value:this.getDispNum(t,!0)},{label:(0,c.kW)("trade_borrow_modal_label_borrowed"),value:this.getDispNum(n,!1)},{label:(0,c.kW)("trade_borrow_label_pending_borrow_orders"),value:this.getDispNum(a,!1)},{label:(0,c.kW)("trade_borrow_modal_label_hourly_rate"),value:u._u.showFloorTruncation(u._u.mul(r,100),8,{needZero:!1,style:"percent"})}]:[{label:(0,c.kW)("trade_borrow_modal_label_can_repay"),value:this.getDispNum(o,!1)},{label:(0,c.kW)("trade_borrow_modal_label_borrowed"),value:this.getDispNum(n,!1)},{label:(0,c.kW)("trade_borrow_modal_label_interest"),value:this.getDispNum(i,!1)}]}}])}(d.A))},8624:(e,t,n)=>{n.d(t,{A:()=>a});const a=new(n(3533).A)},73267:(e,t,n)=>{n.d(t,{A:()=>k});var a=n(89379),r=n(5544),o=n(92901),i=n(23029),s=n(41594),c=n(4536),u=n(30631),l=n(89347),d=n(42182),_=n(53627),m=n(57628),A=n(31486),p=n(19919),h=(0,s.lazy)((function(){return Promise.all([n.e("vendors-node_modules_ok_okd_components_Slider_index_js"),n.e("vendors-node_modules_ok_okd_components_Radio_index_less-node_modules_ok_okd_components_Slider-d8155b"),n.e("QuickMarginTransferBody")]).then(n.bind(n,93968))}));const b=function(e){return(0,p.jsx)("div",{className:A.A.container,style:{minHeight:298},children:(0,p.jsx)(s.Suspense,{fallback:(0,p.jsx)(m.A,{}),children:(0,p.jsx)(h,(0,a.A)({},e))})})};var v=n(70347),f=n(97762),y=_.$G.ADD;const k=new((0,o.A)((function e(){var t=this;(0,i.A)(this,e),this.getInitProps=function(e){var t=e.instId,n=e.ccy,a=e.type,o=t.split("-"),i=(0,r.A)(o,1)[0];return{instId:t,ccy:n||i,type:a}},this.show=function(e){var n=e.instId,r=e.ccy,o=e.type,i=void 0===o?y:o,s=e.successCallback,_=void 0===s?d.x7:s,m=e.defaultPercent,A=e.defaultType,h=t.getInitProps({instId:n,ccy:r,type:i});f.A.changeData(h);var k=(0,l.v)(v.A);v.A.successCallback=_,v.A.instance=u.A.action((0,a.A)({title:(0,c.kW)("trade_collateral_modal_title_collaterals"),children:(0,p.jsx)(b,{defaultPercent:m,defaultType:A}),onConfirm:f.A.onClickConfirm},k))}})))},97762:(e,t,n)=>{n.d(t,{A:()=>b});var a=n(90675),r=n(10467),o=n(92901),i=n(23029),s=n(71491),c=n(4536),u=n(26204),l=n(75376),d=n(42182),_=n(75627),m=n(63510),A=n(59169),p=n(70347),h=n(82422);const b=new((0,o.A)((function e(){var t=this;(0,i.A)(this,e),this.init=(0,r.A)((0,a.A)().mark((function e(){var n,r,o,i=arguments;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=i.length>0&&void 0!==i[0]?i[0]:{}).defaultPercent,(o=n.defaultType)&&t.onTypeChange(o),e.next=4,t.fetchAmount();case 4:"number"===typeof r&&t.onPercentChange(r,h.A.digit);case 5:case"end":return e.stop()}}),e)}))),this.destroy=function(){t.clearInputAndAvailData()},this.clearInputAndAvailData=function(){t.changeData({amt:"",percent:0,availNum:0})},this.fetchAmount=(0,r.A)((0,a.A)().mark((function e(){var n,r,o,i,s,c,u,l,d;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,_.Ei)()){e.next=2;break}return e.abrupt("return");case 2:return t.clearInputAndAvailData(),n=h.A.type,r=h.A.ccy,o=h.A.isAdd,i=h.A.instId,s={instId:i,type:n,ccy:r,amt:1},e.prev=5,e.next=8,m.A.getMarginBalance(s);case 8:c=e.sent,u=c.balanceAmount,l=c.maxAmount,d=Number(o?l:u),t.changeData({availNum:d}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),(0,A.Z2)(e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,15]])}))),this.onTypeChange=function(e){t.changeData({type:e}),t.fetchAmount()},this.onCcyChange=function(e){t.changeData({ccy:e}),t.fetchAmount()},this.onPercentChange=function(e,n){t.changeData({percent:e});var a=s._u.mul(h.A.availNum,h.A.percentValue);h.A.isAdd||(a=s._u.ceilTruncate(a,n)),t.changeData({amt:a})},this.onAmtChange=function(e){var n=0,a="";if(e){var r=h.A.availNum,o=h.A.availNumFormate;a=e>r?o:e;var i=s._u.div(a,r);n=s._u.floorTruncate(s._u.mul(i,100),0)}t.changeData({amt:a,percent:n})},this.changeData=function(e){if(h.A.update(e),(0,_.Ei)()){var t=h.A.amt,n=!Number(t);p.A.update({confirmDisabled:n})}},this.onClickConfirm=(0,r.A)((0,a.A)().mark((function e(){var t,n,r,o,i,l,d,b;return(0,a.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,_.Ei)()){e.next=2;break}return e.abrupt("return",Promise.reject());case 2:return t=h.A.type,n=h.A.amt,r=h.A.ccy,o=h.A.percent,i=h.A.instId,l=h.A.isAdd,d={type:t,ccy:r,instId:i},100===Number(o)?d.percent="1":d.amt=s._u.toPlainString(n),e.prev=5,e.next=8,m.A.postModifyMargin(d);case 8:return p.A.successCallback(),p.A.destroy(),b=l?(0,c.kW)("trade_toast_notif_transfer_success"):(0,c.kW)("trade_toast_notif_sent_success"),u.A.success(b),e.abrupt("return",Promise.resolve());case 15:return e.prev=15,e.t0=e.catch(5),(0,A.Z2)(e.t0),e.abrupt("return",Promise.reject());case 19:case"end":return e.stop()}}),e,null,[[5,15]])}))),this.onClickTransfer=function(){if(!t.importingTransfer){var e=h.A.ccy,a=(l.A.coins[e]||{}).id,r=[{currencyId:Number(a),currency:e}];t.importingTransfer=!0,Promise.all([n.e("vendors-node_modules_ok_okd_components_Animation_SvgAnimation_js"),n.e("vendors-node_modules_ok_okd_components_Animation_index_less-node_modules_ok_okd_components_Re-f4767f"),n.e("vendors-node_modules_ok_experiment-js-client_dist_experiment_umd_js-node_modules_ok_okd_compo-812c4c"),n.e("vendors-node_modules_ok_blade_lib_web-storage_src_LS_js-node_modules_ok_blade_lib_web-storage-975cbe"),n.e("vendors-node_modules_fuse_js_dist_fuse_mjs"),n.e("@ok-Transfer")]).then(n.bind(n,13532)).then((function(e){var n=e.OKTransfer,a=e.TransferAccount,o=a.ID_WALLET,i=a.ID_UNIFIED;n.show({fromId:o,toId:i,canProductChange:!0,canCurrencyChange:!0,currencyList:r,closeCallback:d.x7,successCallback:t.fetchAmount})})).catch((function(e){(0,A.H4)(e)})).finally((function(){t.importingTransfer=!1}))}}})))},70347:(e,t,n)=>{n.d(t,{A:()=>a});const a=new(n(3533).A)},82422:(e,t,n)=>{n.d(t,{A:()=>A});var a=n(23029),r=n(92901),o=n(39874),i=n(85501),s=n(44497),c=n(4536),u=n(71491),l=n(67530),d=n(53627),_=d.$G.ADD,m=d.$G.REDUCE;const A=new(function(e){function t(){var e;return(0,a.A)(this,t),(e=(0,o.A)(this,t)).type=_,e.availNum=0,e.tabs=[{id:_,tab:(0,c.kW)("trade_collateral_modal_tab_transfer_in")},{id:m,tab:(0,c.kW)("trade_collateral_modal_tab_transfer_out")}],e.ccyTitle=(0,c.kW)("trade_collateral_modal_label_crypto_type"),(0,s.makeObservable)(e,{type:s.observable,typeId:s.computed,availNum:s.observable,isAdd:s.computed,inputTitle:s.computed,availNumList:s.computed,availNumFormate:s.computed}),e}return(0,i.A)(t,e),(0,r.A)(t,[{key:"typeId",get:function(){return this.type}},{key:"isAdd",get:function(){return this.type===_}},{key:"inputTitle",get:function(){return"".concat((0,c.kW)("trade_collateral_modal_label_amount")," (").concat(this.ccy,")")}},{key:"availNumList",get:function(){var e=this.isAdd,t=this.availNum;return[{label:e?(0,c.kW)("trade_collateral_modal_text_transfer_in"):(0,c.kW)("trade_collateral_modal_text_transfer_out"),value:this.getDispNum(t,e)}]}},{key:"availNumFormate",get:function(){var e=this.digit,t=this.availNum;return this.isAdd?t:u._u.ceilTruncate(t,e)}}])}(l.A))},57628:(e,t,n)=>{n.d(t,{A:()=>i});n(41594);var a=n(67939);const r="index_loading__TSBhl";var o=n(19919);const i=function(){return(0,o.jsx)(a.A,{className:r})}},3533:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(92901),r=n(23029),o=n(42182);const i=(0,a.A)((function e(){var t=this;(0,r.A)(this,e),this.update=function(e){t.instance&&t.instance.update(e)},this.destroy=function(){t.instance&&(t.instance.destroy(),t.instance=null),t.successCallback=o.x7},this.instance=null,this.successCallback=o.x7}))},67530:(e,t,n)=>{n.d(t,{A:()=>_});var a=n(23029),r=n(92901),o=n(39874),i=n(85501),s=n(44497),c=n(71491),u=n(28494),l=n(76196),d=n(75376);const _=function(e){function t(){var e;return(0,a.A)(this,t),(e=(0,o.A)(this,t)).instId="",e.ccy="",e.amt="",e.percent=0,(0,s.makeObservable)(e,{instId:s.observable,ccy:s.observable,amt:s.observable,percent:s.observable,ccyList:s.computed,percentValue:s.computed,digit:s.computed}),e}return(0,i.A)(t,e),(0,r.A)(t,[{key:"ccyList",get:function(){var e=this.instId;return e?e.split("-"):[]}},{key:"percentValue",get:function(){return c._u.div(this.percent,100)}},{key:"digit",get:function(){var e=this.instId;if(!e)return u.X9;var t=d.A.configs[u.gy.MARGIN][e].positionDig;return Number(t)}},{key:"getDispNum",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.digit,a=this.ccy,r=t?c._u.showFloorTruncation(e,n):c._u.showCeilTruncation(e,n);return"".concat(r," ").concat(a)}}])}(l.A)},89347:(e,t,n)=>{n.d(t,{v:()=>s});var a=n(89379),r=n(4536),o=n(75627),i=n(29810),s=function(e){var t=(0,o.Ei)()?{confirmText:(0,r.kW)("options_buyoptions_modal_btn_confirm"),cancelText:(0,r.kW)("options_buyoptions_modal_btn_cancel")}:{confirmText:(0,r.kW)("margin_buyoptions_text_login_button")},n=(0,o.Ei)()?{}:{block:!0,href:i.Ay.getLoginPath(),target:"_self"};return(0,a.A)((0,a.A)({noContentPadding:!0},t),{},{confirmBtnProps:n,onClose:e.destroy,onCancel:e.destroy})}},31486:(e,t,n)=>{n.d(t,{A:()=>a});const a={container:"body_container__fsd0Q"}}}]);
//# sourceMappingURL=https://static-daily.okg.com/crash/okfe/comb-trade/src_common_bizComps_QuickMargin_BorrowRepay_actions_openAction_js-src_common_bizComps_QuickMa-48644e/index.fef5a041.js.map